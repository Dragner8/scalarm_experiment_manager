$("#bivariate_charts").prepend("<div id='wrapper_<%= @container_id %>'></div>");
$("#wrapper_<%= @container_id %>").html("<%= escape_javascript(render partial: 'bivariate_chart') %>")

$(document).ready(function() {
    new Highcharts.Chart({
  	chart: {
  		renderTo: '<%= @container_id %>',
        type: 'scatter'
  	},
  	title: { text: '\'<%= @chart.x_axis_label %>\' versus \'<%= @chart.y_axis_label %>\'' },
  	xAxis: {
  		title: { text: '<%= @chart.x_axis_label %>' }
  	},
  	yAxis: {
  		title: { text: '<%= @chart.y_axis_label %>' }
  	},
    tooltip: {
        formatter: function () {
            return '<%= @chart.x_axis_label %>: <b>' + this.x + '</b><br/><%= @chart.y_axis_label %>: <b>' + this.y + '</b>';
        }
    },
  	plotOptions: {
  	},
  	credits: { enabled: false },
  	series: [{
        name: '<%= @chart.x_axis_label.split(" - ")[-1]%>',
        color: 'rgba(223, 83, 83, .5)',
        data: [
            <% @chart.chart_data.each do |x_value, y_values|
                 y_values.each do |y_value| %>
                  [ <%= x_value %>, <%= y_value %> ],
                <% end
            end %>
        ]
    }]
	});
});
$('#busy_bivariate').hide();
// scroll to
var targetOffset =  $('#wrapper_<%= @container_id %>').offset().top;
$('html,body').animate({scrollTop: targetOffset}, 1000);