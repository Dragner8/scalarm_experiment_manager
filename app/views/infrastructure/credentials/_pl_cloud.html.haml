- pl_cloud_secrets_creds = CloudSecrets.find_by_query('cloud_name'=>'pl_cloud', 'user_id'=>user.id)

%row#plcloud-credentials
  = form_tag add_infrastructure_credentials_infrastructure_path, remote: true, class: 'custom' do
    = hidden_field_tag 'infrastructure_type', 'pl_cloud'
    = hidden_field_tag 'credential_type', 'secrets'

    %h5.subheader= t('.credentials_label')

    %fieldset
      .row
        .small-4.columns
          = label_tag :stored_login, t('.credentials.login') + ':', class: 'inline right'
        .small-4.columns
          = text_field_tag :stored_login, pl_cloud_secrets_creds.nil? ? '' : pl_cloud_secrets_creds.login
        .small-4.columns
      .row
        .small-4.columns
          = label_tag :stored_secret_password, t('.credentials.password') + ':', class: 'inline right'
        .small-4.columns
          = password_field_tag :stored_secret_password, pl_cloud_secrets_creds.nil? ? '' : pl_cloud_secrets_creds.secret_password
        .small-4.columns
      .row
        .small-4.columns
          = label_tag :save_settings, t('.credentials.save_settings') + ':', class: 'inline right'
        .small-4.columns
          = check_box_tag :save_settings, '1', (not pl_cloud_secrets_creds.nil?)
        .small-4.columns
      .row
        .small-12.columns.text-center
          = submit_tag t('infrastructure.information.submit'), class: 'button radius'
          = image_tag 'loading.gif', id: 'plgrid-configure-busy', style: 'display: none;'

  = button_to t('infrastructure.information.remove_credentials'),
    remove_credentials_infrastructure_path(user_id: @current_user.id, cloud_name: 'pl_cloud'),
      class: "remove-button button radius tiny", remote: true, form: { "data-type" => "json" }

= content_for :javascript do
  :javascript
    $(function() {
      new window.InformationDialog('plcloud-credentials',
                                   'plcloud-submission-panel',
                                   '#extension-dialog',
                                   '.plcloud-credentials-busy');
    });
